# SLURM Configuration for Emulator Testing
# Example configuration based on provided parameters

# SCHEDULING
PriorityType             = priority/multifactor
PriorityDecayHalfLife   = 15-00:00:00
PriorityCalcPeriod      = 00:05:00
PriorityFavorSmall      = No
PriorityFlags           = NO_NORMAL_ASSOC
PriorityMaxAge          = 14-00:00:00
PriorityUsageResetPeriod = None # manual reset via sacctmgr RawUsage=0
PriorityType            = priority/multifactor
PriorityWeightAge       = 172800 # 2 day in minutes (2880) x 60
PriorityWeightAssoc     = 100000
PriorityWeightFairShare = 259200 # 3 day in minutes (4320) x 60
PriorityWeightJobSize   = 0
PriorityWeightPartition = 172800 # 2 day in minutes (2880) x 60
PriorityWeightQOS       = 500000
FairShareDampeningFactor = 3
SchedulerType=sched/backfill
PriorityFlags=MAX_TRES

# TRESBillingWeights, in general weights are 1/ncores and 1/mem_gb
TRESBillingWeights="CPU=0.015625,Mem=0.001953125G,GRES/gpu=0.25" # correct to get the fraction of node used on bristen 64 cores 512GB RAM 4 GPU

# Alternative billing weights (commented out)
# TRESBillingWeights="CPU=1.0,Mem=0.125G,GRES/gpu=16" # correct to get the fraction of 64cpus used on bristen 64 cores 512GB RAM 4 GPU

# Additional standard SLURM settings
ClusterName=emulator-cluster
ControlMachine=localhost
AuthType=auth/munge
CryptoType=crypto/munge
MpiDefault=none
ReturnToService=1
SlurmctldPidFile=/var/run/slurmctld.pid
SlurmctldPort=6817
SlurmdPidFile=/var/run/slurmd.pid
SlurmdPort=6818
SlurmdSpoolDir=/var/spool/slurmd
SlurmUser=slurm
StateSaveLocation=/var/spool/slurmctld
SwitchType=switch/none
TaskPlugin=task/affinity
TaskPluginParam=Sched

# LOGGING AND ACCOUNTING
SlurmctldDebug=info
SlurmctldLogFile=/var/log/slurm/slurmctld.log
SlurmdDebug=info
SlurmdLogFile=/var/log/slurm/slurmd.log
JobCompType=jobcomp/none

# COMPUTE NODES (example)
NodeName=node[001-004] CPUs=64 RealMemory=524288 Gres=gpu:4 State=UNKNOWN
PartitionName=debug Nodes=node[001-004] Default=YES MaxTime=INFINITE State=UP
